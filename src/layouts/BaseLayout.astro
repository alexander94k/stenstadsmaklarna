---
export interface Props {
  title: string;
  description: string;
  canonicalUrl: string;
  pageType?: 'website' | 'article';
  articleDate?: string;
  articleModified?: string;
}

const {
  title,
  description,
  canonicalUrl,
  pageType = 'website',
  articleDate,
  articleModified
} = Astro.props;

const siteName = "Stenstadsmäklarna";
const siteUrl = "https://stenstadsmaklarna.se";
const logoUrl = `${siteUrl}/logo.png`;

// LocalBusiness Schema for all pages
const localBusinessSchema = {
  "@context": "https://schema.org",
  "@type": "RealEstateAgent",
  "name": "Stenstadsmäklarna",
  "image": logoUrl,
  "url": siteUrl,
  "telephone": "+46739823962",
  "email": "info@stenstadsmaklarna.se",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "Björneborgsgatan 36",
    "addressLocality": "Sundsvall",
    "addressRegion": "Västernorrlands län",
    "postalCode": "854 60",
    "addressCountry": "SE"
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": 62.3908,
    "longitude": 17.3069
  },
  "openingHoursSpecification": [
    {
      "@type": "OpeningHoursSpecification",
      "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
      "opens": "09:00",
      "closes": "17:00"
    }
  ],
  "priceRange": "$$",
  "areaServed": {
    "@type": "City",
    "name": "Sundsvall"
  },
  "sameAs": []
};

// WebPage Schema
const webPageSchema = {
  "@context": "https://schema.org",
  "@type": pageType === 'article' ? "Article" : "WebPage",
  "name": title,
  "description": description,
  "url": canonicalUrl,
  "publisher": {
    "@type": "Organization",
    "name": siteName,
    "url": siteUrl,
    "logo": {
      "@type": "ImageObject",
      "url": logoUrl
    }
  },
  ...(pageType === 'article' && articleDate && {
    "datePublished": articleDate,
    "dateModified": articleModified || articleDate,
    "author": {
      "@type": "Organization",
      "name": siteName
    }
  })
};

// BreadcrumbList Schema
const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Hem",
      "item": siteUrl
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": title.split(' | ')[0],
      "item": canonicalUrl
    }
  ]
};
---

<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Primary Meta Tags -->
  <title>{title}</title>
  <meta name="title" content={title}>
  <meta name="description" content={description}>
  <meta name="author" content={siteName}>
  <meta name="robots" content="index, follow">

  <!-- Canonical URL -->
  <link rel="canonical" href={canonicalUrl}>

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content={pageType === 'article' ? 'article' : 'website'}>
  <meta property="og:url" content={canonicalUrl}>
  <meta property="og:title" content={title}>
  <meta property="og:description" content={description}>
  <meta property="og:site_name" content={siteName}>
  <meta property="og:locale" content="sv_SE">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content={canonicalUrl}>
  <meta name="twitter:title" content={title}>
  <meta name="twitter:description" content={description}>

  <!-- Geo Tags -->
  <meta name="geo.region" content="SE-Y">
  <meta name="geo.placename" content="Sundsvall">
  <meta name="geo.position" content="62.3908;17.3069">
  <meta name="ICBM" content="62.3908, 17.3069">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Source+Serif+4:wght@400;500;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Schema.org Structured Data -->
  <script type="application/ld+json" set:html={JSON.stringify(localBusinessSchema)}></script>
  <script type="application/ld+json" set:html={JSON.stringify(webPageSchema)}></script>
  <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)}></script>

  <slot name="head" />
</head>
<body>
  <slot />
</body>
</html>
